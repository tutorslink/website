<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutors Link</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* Base Reset */
* {margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif;}
body {background:#000; color:#fff; overflow-x:hidden;}
a, button {text-decoration:none; color:inherit; cursor:pointer;}
.container {max-width:1200px; margin:0 auto; padding:0 20px;}

/* Hero */
header {
  background:linear-gradient(135deg, #ff00ff, #00f0ff);
  position:relative;
  text-align:center;
  padding:120px 20px;
  overflow:hidden;
}
header h1 {font-size:3rem; margin-bottom:20px; position:relative; z-index:10;}
header p {font-size:1.2rem; margin-bottom:30px; position:relative; z-index:10;}
.cta-buttons {position:relative; z-index:10;}
.cta-buttons button {
  background:#fff; color:#000; font-weight:700; padding:12px 30px; margin:0 10px; border-radius:12px;
  transition:0.3s;
}
.cta-buttons button:hover {background:#ff0; color:#000; transform:scale(1.05);}

/* Abstract decorations */
header::before, header::after {
  content:''; position:absolute; border-radius:50%; opacity:0.2; z-index:1;
}
header::before {width:400px; height:400px; background:#ff0; top:-100px; left:-150px;}
header::after {width:600px; height:600px; background:#ff00ff; bottom:-200px; right:-200px;}

/* Sections */
section {padding:80px 0; position:relative;}
h2 {font-size:2.5rem; margin-bottom:40px; text-align:center; background:linear-gradient(90deg,#ff0,#ff00ff,#00f0ff); -webkit-background-clip:text; -webkit-text-fill-color:transparent;}
p {margin-bottom:15px; line-height:1.6; color:#eee; transition:0.3s;}
p:hover, h4:hover, h3:hover {color:#ff0;}

/* How it Works */
.steps {display:flex; flex-wrap:wrap; justify-content:center; gap:30px;}
.step {background:#111; padding:30px; border-radius:20px; flex:1 1 300px; text-align:center; box-shadow:0 0 15px #ff00ff55; transition:0.3s;}
.step h3 {margin-bottom:15px; color:#ff0;}
.step:hover {transform:translateY(-10px); box-shadow:0 0 25px #ff0,0 0 35px #00f0ff;}

/* Policies */
.policy {background:#111; margin-bottom:20px; padding:25px; border-radius:15px; box-shadow:0 0 10px #ff00ff33; transition:0.3s; cursor:pointer;}
.policy:hover {box-shadow:0 0 20px #ff0,0 0 25px #00f0ff;}
.policy h4 {display:flex; justify-content:space-between; align-items:center; font-size:1.2rem;}
.policy-content {display:none; margin-top:15px; line-height:1.5; color:#eee;}

/* Reviews */
.reviews {display:flex; flex-wrap:wrap; gap:25px; justify-content:center;}
.review {background:#111; padding:25px; border-radius:15px; box-shadow:0 0 10px #ff00ff33; width:250px; transition:0.3s;}
.review:hover {transform:translateY(-10px); box-shadow:0 0 25px #ff0,0 0 35px #00f0ff;}

/* Find a Tutor */
#find-tutor {background:#111; padding:100px 0;}
.tutor-cards {display:flex; flex-wrap:wrap; justify-content:center; gap:25px;}
.tutor-card {background:#222; padding:25px; border-radius:15px; width:250px; text-align:center; box-shadow:0 0 10px #ff00ff33; transition:0.3s;}
.tutor-card:hover {transform:translateY(-10px); box-shadow:0 0 25px #ff0,0 0 35px #00f0ff;}
.tutor-card h3 {margin-bottom:10px; color:#ff0;}

/* Banner / Navigation */
.top-banner {
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  padding: 15px 0;
  position: sticky;
  top: 0;
  z-index: 999;
  box-shadow: 0 4px 20px rgba(255, 0, 255, 0.3);
  border-bottom: 2px solid #ff00ff;
}
.banner-content {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 15px;
}
.logo-section h1 {
  font-size: 1.5rem;
  margin: 0;
  background: linear-gradient(90deg, #ff0, #ff00ff, #00f0ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.profile-info {
  display: flex;
  align-items: center;
  gap: 15px;
  background: rgba(255, 255, 255, 0.05);
  padding: 10px 20px;
  border-radius: 25px;
  backdrop-filter: blur(10px);
}
.role-badge {
  padding: 5px 15px;
  border-radius: 15px;
  font-weight: 700;
  font-size: 0.85rem;
  text-transform: uppercase;
}
.role-guest { background: #666; color: #fff; }
.role-student { background: #00f0ff; color: #000; }
.role-tutor { background: #ff0; color: #000; }
.role-staff { background: #ff00ff; color: #fff; }
.role-admin { background: linear-gradient(90deg, #ff0, #ff00ff); color: #fff; }
.banner-nav {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}
.banner-nav button {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  padding: 8px 20px;
  border: none;
  border-radius: 20px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}
.banner-nav button:hover {
  background: #ff00ff;
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(255, 0, 255, 0.5);
}

/* Staff Portal */
#staff-portal {
  background: #111;
  padding: 80px 0;
  display: none; /* Hidden by default, shown only for staff/admin */
}
#staff-portal form {max-width:600px; margin:0 auto; display:flex; flex-direction:column; gap:15px;}
#staff-portal input, #staff-portal select, #staff-portal textarea {padding:10px; border-radius:8px; border:none;}
#staff-portal button {background:#ff0; color:#000; padding:12px; font-weight:700; border-radius:10px; cursor:pointer; transition:0.3s;}
#staff-portal button:hover {background:#ff00ff; color:#fff;}

/* Tutors Display */
.tutor-display {display:flex; flex-wrap:wrap; gap:20px; justify-content:center;}
.tutor-box {background:#111; padding:20px; border-radius:15px; width:250px; box-shadow:0 0 10px #ff00ff33; transition:0.3s;}
.tutor-box h4 {color:#ff0; margin-bottom:10px;}
.tutor-box p {color:#eee; margin-bottom:5px;}

/* Support messages */
#support {display: none;} /* Removed - chatbot coming later */

/* Schedule Section */
#schedule {
  background: #0a0a0a;
  padding: 80px 0;
  display: none; /* Shown for students, tutors, admins */
}
.schedule-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}
.schedule-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-top: 30px;
}
.schedule-card {
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  padding: 25px;
  border-radius: 15px;
  border: 2px solid #ff00ff33;
  transition: all 0.3s;
}
.schedule-card:hover {
  border-color: #ff00ff;
  box-shadow: 0 0 30px rgba(255, 0, 255, 0.4);
  transform: translateY(-5px);
}
.schedule-card h3 {
  color: #ff0;
  margin-bottom: 15px;
}
.schedule-item {
  background: rgba(255, 255, 255, 0.05);
  padding: 15px;
  margin: 10px 0;
  border-radius: 10px;
  border-left: 4px solid #00f0ff;
}
.schedule-item .time {
  color: #ff0;
  font-weight: 700;
  margin-bottom: 5px;
}
.schedule-item .details {
  color: #eee;
  font-size: 0.9rem;
}

/* Find Tutor with Categories */
.tutor-categories {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 25px;
  margin-top: 40px;
}
.category-card {
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  padding: 30px;
  border-radius: 20px;
  border: 2px solid transparent;
  transition: all 0.3s;
  cursor: pointer;
}
.category-card:hover {
  border-color: #ff00ff;
  box-shadow: 0 0 35px rgba(255, 0, 255, 0.5);
  transform: translateY(-8px);
}
.category-card h3 {
  color: #ff0;
  font-size: 1.5rem;
  margin-bottom: 15px;
  text-align: center;
}
.category-subjects {
  display: none;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 2px solid #333;
}
.category-card.expanded .category-subjects {
  display: block;
}
.subject-item {
  background: rgba(0, 240, 255, 0.1);
  padding: 12px 15px;
  margin: 8px 0;
  border-radius: 10px;
  border-left: 3px solid #00f0ff;
  color: #eee;
  transition: 0.3s;
}
.subject-item:hover {
  background: rgba(0, 240, 255, 0.2);
  border-left-color: #ff0;
  transform: translateX(5px);
}
.expand-indicator {
  text-align: center;
  color: #999;
  margin-top: 15px;
  font-size: 0.9rem;
}
.category-card.expanded .expand-indicator::before {
  content: 'Click to collapse ‚ñ≤';
}
.expand-indicator::before {
  content: 'Click to expand ‚ñº';
}

/* Apply & Footer */
.apply, footer {background:#000; color:#fff; text-align:center; padding:60px 20px;}
.apply a, footer a {color:#ff0; font-weight:700; transition:0.3s;}
.apply a:hover, footer a:hover {color:#ff00ff;}

/* Auth Modal */
.auth-modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:1000; justify-content:center; align-items:center;}
.auth-content {background:#111; padding:40px; border-radius:20px; max-width:450px; width:90%; box-shadow:0 0 30px #ff00ff; position:relative;}
.auth-content h2 {text-align:center; margin-bottom:25px; font-size:2rem;}
.auth-content input {width:100%; padding:12px; margin-bottom:15px; border-radius:8px; border:none; font-size:1rem;}
.auth-content button {width:100%; background:#ff0; color:#000; padding:12px; border-radius:8px; border:none; font-weight:700; cursor:pointer; transition:0.3s; font-size:1rem; margin-bottom:10px;}
.auth-content button:hover {background:#ff00ff; color:#fff;}
.auth-divider {text-align:center; margin:20px 0; color:#aaa; position:relative;}
.auth-divider::before, .auth-divider::after {content:''; position:absolute; top:50%; width:40%; height:1px; background:#444;}
.auth-divider::before {left:0;}
.auth-divider::after {right:0;}
.google-signin-btn {background:#fff !important; color:#333 !important; display:flex; align-items:center; justify-content:center; gap:10px; font-weight:600 !important;}
.google-signin-btn:hover {background:#f0f0f0 !important; color:#000 !important;}
.google-signin-btn img {width:20px; height:20px;}
.auth-toggle {text-align:center; margin-top:15px; color:#aaa;}
.auth-toggle a {color:#ff0; cursor:pointer; font-weight:600;}
.auth-toggle a:hover {color:#ff00ff;}
.auth-close {position:absolute; top:15px; right:20px; font-size:30px; color:#aaa; cursor:pointer; transition:0.3s; background:none; border:none; padding:0;}
.auth-close:hover {color:#ff0;}

/* Profile Modal */
.profile-modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:1000; justify-content:center; align-items:center;}
.profile-content {background:#111; padding:40px; border-radius:20px; max-width:500px; width:90%; max-height:80vh; overflow-y:auto; box-shadow:0 0 30px #ff00ff; position:relative;}
.profile-content h2 {text-align:center; margin-bottom:25px; font-size:2rem;}
.profile-content h3 {color:#ff0; margin-bottom:15px; font-size:1.2rem; border-bottom:2px solid #ff00ff; padding-bottom:8px;}
.profile-section {margin-bottom:30px;}
.profile-field {display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #333;}
.profile-field label {color:#aaa; font-weight:600;}
.profile-field span {color:#fff;}
.profile-content input {width:100%; padding:12px; margin-bottom:15px; border-radius:8px; border:none; font-size:1rem;}
.profile-content button {width:100%; background:#ff0; color:#000; padding:12px; border-radius:8px; border:none; font-weight:700; cursor:pointer; transition:0.3s; font-size:1rem;}
.profile-content button:hover {background:#ff00ff; color:#fff;}
.profile-close {position:absolute; top:15px; right:20px; font-size:30px; color:#aaa; cursor:pointer; transition:0.3s; background:none; border:none; padding:0; width:auto;}
.profile-close:hover {color:#ff0;}
.profile-content p {color:#aaa; margin-bottom:15px; line-height:1.6;}

/* Responsive */
@media(max-width:768px){.steps,.tutor-cards,.tutor-display{flex-direction:column; align-items:center;}}
</style>
</head>
<body>

<!-- Top Banner with Profile Info -->
<div class="top-banner">
  <div class="banner-content">
    <div class="logo-section">
      <h1>üéì Tutors Link</h1>
    </div>
    <div class="profile-info" id="profile-info" style="display:none;">
      <span id="user-name-display">Guest</span>
      <span class="role-badge role-guest" id="user-role-badge">Guest</span>
    </div>
    <nav class="banner-nav">
      <button onclick="scrollToSection('find-tutor')">Find a Tutor</button>
      <button id="schedule-nav-btn" onclick="scrollToSection('schedule')" style="display:none;">Schedule</button>
      <button id="staff-portal-nav-btn" onclick="scrollToSection('staff-portal')" style="display:none;">Staff Portal</button>
      <button id="banner-login-btn" onclick="openAuthModal('login')">Login</button>
      <button id="banner-signup-btn" onclick="openAuthModal('signup')">Sign Up</button>
      <button id="banner-profile-btn" onclick="openProfileModal()" style="display:none;">Profile</button>
      <button id="banner-logout-btn" onclick="handleLogout()" style="display:none;">Logout</button>
    </nav>
  </div>
</div>

<!-- Hero -->
<header>
<h1>Tutors Link</h1>
<p>Connect with tutors worldwide. Free for students, prices set by tutors. All payments secure through Tutors Link.</p>
<div class="cta-buttons">
  <button onclick="window.location='#find-tutor'">Find a Tutor</button>
  <button onclick="window.location='apply-as-tutor.html'">Apply as Tutor</button>
</div>
</header>



<!-- Auth Modal -->
<div class="auth-modal" id="auth-modal" role="dialog" aria-labelledby="auth-title" aria-modal="true">
  <div class="auth-content">
    <button class="auth-close" onclick="closeAuthModal()" aria-label="Close authentication modal" type="button">&times;</button>
    <h2 id="auth-title">Login</h2>
    <form id="auth-form">
      <input type="email" id="auth-email" placeholder="Email Address" aria-label="Email address" required>
      <input type="password" id="auth-password" placeholder="Password" aria-label="Password" required minlength="6">
      <button type="submit" id="auth-submit-btn">Login</button>
    </form>
    <div class="auth-divider">OR</div>
    <button type="button" id="google-signin-btn" class="google-signin-btn" aria-label="Sign in with Google">
      <svg width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
      </svg>
      Continue with Google
    </button>
    <div class="auth-toggle">
      <span id="auth-toggle-text">Don't have an account?</span>
      <a id="auth-toggle-link" onclick="toggleAuthMode()" role="button" tabindex="0">Sign Up</a>
    </div>
  </div>
</div>

<!-- Profile Modal -->
<div class="profile-modal" id="profile-modal" role="dialog" aria-labelledby="profile-title" aria-modal="true">
  <div class="profile-content">
    <button class="profile-close" onclick="closeProfileModal()" aria-label="Close profile modal" type="button">&times;</button>
    <h2 id="profile-title">Profile</h2>
    
    <div class="profile-section">
      <h3>Account Details</h3>
      <div class="profile-field">
        <label>Email:</label>
        <span id="profile-email">-</span>
      </div>
      <div class="profile-field">
        <label>Display Name:</label>
        <span id="profile-display-name">-</span>
      </div>
      <div class="profile-field">
        <label>Role:</label>
        <span id="profile-role">-</span>
      </div>
    </div>

    <div class="profile-section">
      <h3>Update Display Name</h3>
      <form id="display-name-form">
        <input type="text" id="new-display-name" placeholder="Enter new display name" aria-label="New display name" required minlength="2">
        <button type="submit">Update Display Name</button>
      </form>
    </div>

    <div class="profile-section">
      <h3>Reset Password</h3>
      <p>A password reset link will be sent to your email address.</p>
      <button id="reset-password-btn" onclick="handlePasswordReset()">Send Reset Link</button>
    </div>
  </div>
</div>

<!-- How it Works -->
<section id="how-it-works">
<h2>How It Works</h2>
<div class="container steps">
  <div class="step"><h3>Students</h3><p>Browse tutors ‚Üí Demo class ‚Üí Make payment ‚Üí Connect via Discord</p></div>
  <div class="step"><h3>Tutors</h3><p>Apply ‚Üí Get approved ‚Üí Teach ‚Üí Receive fees securely</p></div>
</div>
</section>

<!-- Policies -->
<section id="policies">
<h2>Platform Policies</h2>
<div class="container">
  <div class="policy"><h4>For Tutors</h4>
    <div class="policy-content"><ul>
      <li>Hide identity until payment is made.</li>
      <li>Do not share contact info before payment.</li>
      <li>Accept 40% commission first month.</li>
      <li>Must be 13+ years old.</li>
    </ul></div>
  </div>
  <div class="policy"><h4>For Students</h4>
    <div class="policy-content"><ul>
      <li>Pay 100% before connecting with tutor.</li>
      <li>Do not share contact info before payment.</li>
      <li>Fees held first month, then transferred to tutor.</li>
      <li>Price per class fixed by tutor.</li>
    </ul></div>
  </div>
  <div class="policy"><h4>General</h4>
    <div class="policy-content"><ul>
      <li>Tutors Link responsible for first-month issues.</li>
      <li>Not responsible after first month.</li>
      <li>Breaking policies may remove access.</li>
    </ul></div>
  </div>
  <div class="policy"><h4>Refunds</h4>
    <div class="policy-content"><ul>
      <li>Refunds only first month.</li>
      <li>Case 1: After demo class, full refund if issues.</li>
      <li>Case 2: During first week, refund for unattended/problem classes.</li>
    </ul></div>
  </div>
</div>
</section>

<!-- Reviews -->
<section id="reviews">
<h2>What Students Say</h2>
<div class="container reviews">
<div class="review">"Amazing tutors! Found the perfect one in minutes."</div>
<div class="review">"Secure payments, very reliable platform!"</div>
<div class="review">"Loved the demo class feature, totally stress-free."</div>
</div>
</section>

<!-- Find a Tutor with Categories -->
<section id="find-tutor">
<h2>Find a Tutor</h2>
<div class="container">
  <p style="text-align:center; color:#eee; margin-bottom:30px;">Browse tutors by level and subject. Click on any category to see available subjects.</p>
  <div class="tutor-categories">
    
    <!-- IGCSE Category -->
    <div class="category-card" onclick="toggleCategory(this)">
      <h3>üìö IGCSE</h3>
      <p style="color:#ccc; text-align:center;">International General Certificate</p>
      <div class="category-subjects">
        <div class="subject-item">Mathematics</div>
        <div class="subject-item">Physics</div>
        <div class="subject-item">Chemistry</div>
        <div class="subject-item">Biology</div>
        <div class="subject-item">English</div>
        <div class="subject-item">Computer Science</div>
        <div class="subject-item">Business Studies</div>
        <div class="subject-item">Economics</div>
      </div>
      <div class="expand-indicator"></div>
    </div>
    
    <!-- AS/A Levels Category -->
    <div class="category-card" onclick="toggleCategory(this)">
      <h3>üéì AS/A Levels</h3>
      <p style="color:#ccc; text-align:center;">Advanced Level Courses</p>
      <div class="category-subjects">
        <div class="subject-item">Mathematics</div>
        <div class="subject-item">Further Mathematics</div>
        <div class="subject-item">Physics</div>
        <div class="subject-item">Chemistry</div>
        <div class="subject-item">Biology</div>
        <div class="subject-item">English Literature</div>
        <div class="subject-item">Computer Science</div>
        <div class="subject-item">Economics</div>
        <div class="subject-item">Business</div>
      </div>
      <div class="expand-indicator"></div>
    </div>
    
    <!-- University Category -->
    <div class="category-card" onclick="toggleCategory(this)">
      <h3>üèõÔ∏è University</h3>
      <p style="color:#ccc; text-align:center;">Higher Education Support</p>
      <div class="category-subjects">
        <div class="subject-item">Calculus</div>
        <div class="subject-item">Linear Algebra</div>
        <div class="subject-item">Programming (Python, Java, C++)</div>
        <div class="subject-item">Data Structures & Algorithms</div>
        <div class="subject-item">Statistics</div>
        <div class="subject-item">Organic Chemistry</div>
        <div class="subject-item">Quantum Physics</div>
        <div class="subject-item">Engineering Mathematics</div>
      </div>
      <div class="expand-indicator"></div>
    </div>
    
    <!-- Test Preparation Category -->
    <div class="category-card" onclick="toggleCategory(this)">
      <h3>üìù Test Preparation</h3>
      <p style="color:#ccc; text-align:center;">Exam Readiness</p>
      <div class="category-subjects">
        <div class="subject-item">SAT</div>
        <div class="subject-item">ACT</div>
        <div class="subject-item">GRE</div>
        <div class="subject-item">GMAT</div>
        <div class="subject-item">IELTS</div>
        <div class="subject-item">TOEFL</div>
        <div class="subject-item">AP Exams</div>
      </div>
      <div class="expand-indicator"></div>
    </div>
    
    <!-- Other Category -->
    <div class="category-card" onclick="toggleCategory(this)">
      <h3>üåü Other</h3>
      <p style="color:#ccc; text-align:center;">Additional Subjects</p>
      <div class="category-subjects">
        <div class="subject-item">Music Theory</div>
        <div class="subject-item">Art & Design</div>
        <div class="subject-item">Language Learning</div>
        <div class="subject-item">Coding & Web Development</div>
        <div class="subject-item">Essay Writing</div>
        <div class="subject-item">Study Skills</div>
      </div>
      <div class="expand-indicator"></div>
    </div>
    
  </div>
  
  <!-- Social Links -->
  <div style="margin-top:50px;">
    <h3 style="text-align:center; color:#ff0; margin-bottom:25px;">Connect With Us</h3>
    <div class="tutor-cards" style="display:flex; justify-content:center; gap:20px; flex-wrap:wrap;">
      <div class="tutor-card" style="width:200px;"><h3>Discord</h3><p>Join our community</p><a href="https://discord.gg/pe8TXPgkAe" target="_blank">Join Server</a></div>
      <div class="tutor-card" style="width:200px;"><h3>Instagram</h3><p>Follow for tips</p><a href="https://instagram.com/tutors.link" target="_blank">@tutors.link</a></div>
      <div class="tutor-card" style="width:200px;"><h3>TikTok</h3><p>Watch videos</p><a href="https://tiktok.com/@tutors_link" target="_blank">@tutors_link</a></div>
    </div>
  </div>
</div>
</section>

<!-- Schedule Section -->
<section id="schedule">
<h2>üìÖ My Schedule</h2>
<div class="schedule-container">
  <p style="text-align:center; color:#ccc; margin-bottom:30px;">View and manage your upcoming sessions</p>
  <div class="schedule-grid" id="schedule-grid">
    <!-- Schedule will be dynamically populated -->
    <div class="schedule-card">
      <h3>Upcoming Sessions</h3>
      <div class="schedule-item">
        <div class="time">No sessions scheduled</div>
        <div class="details">Book a tutor to get started!</div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Staff Portal -->
<section id="staff-portal">
<h2>Staff Portal - Add Tutor</h2>
<form id="add-tutor-form">
  <input type="text" name="name" placeholder="Tutor Name" required>
  <input type="text" name="subjects" placeholder="Subjects" required>
  <input type="text" name="price" placeholder="Price per class" required>
  <input type="text" name="timezone" placeholder="Time Zone" required>
  <input type="text" name="languages" placeholder="Languages" required>
  <select name="category" required>
    <option value="">Select Category</option>
    <option>IGCSE</option>
    <option>AS/A Levels</option>
    <option>University</option>
    <option>Test Preparation</option>
    <option>Other</option>
  </select>
  <button type="submit">Add Tutor</button>
</form>
<div class="tutor-display" id="tutor-list"></div>
</section>

<!-- Apply as Tutor -->
<section id="apply" class="apply">
<h2>Apply as a Tutor</h2>
<p>Ready to share your knowledge and earn as a tutor? Fill out our professional application form!</p>
<a href="apply-as-tutor.html" style="display:inline-block; background:#ff0; color:#000; padding:15px 30px; border-radius:10px; font-weight:700; text-decoration:none; transition:0.3s;">Start Your Application</a>
</section>

<!-- Footer -->
<footer>
<p>Follow us on <a href="https://instagram.com/tutors.link" target="_blank">Instagram</a> | <a href="https://tiktok.com/@tutors_link" target="_blank">TikTok</a></p>
<p>&copy; 2026 Tutors Link. All rights reserved.</p>
</footer>

<script>
// ============================================
// Global State and Imports
// ============================================
let authModule = null;
let firebaseAuthModule = null;

// Import auth module once on load
(async () => {
  try {
    authModule = await import('./auth.js');
  } catch (error) {
    console.error('Failed to load auth module:', error);
  }
})();

// ============================================
// Helper Functions
// ============================================
// Get display name with fallback
function getDisplayName(user, userData) {
  return userData?.displayName || user?.displayName || user?.email?.split('@')[0] || 'User';
}

// ============================================
// Auth Modal Functions (Fallback/Standalone)
// ============================================

// Define these functions globally for fallback
window.openAuthModal = function(mode) {
  const modal = document.getElementById('auth-modal');
  const title = document.getElementById('auth-title');
  const submitBtn = document.getElementById('auth-submit-btn');
  const toggleText = document.getElementById('auth-toggle-text');
  const toggleLink = document.getElementById('auth-toggle-link');
  const form = document.getElementById('auth-form');
  
  if (!modal || !title || !submitBtn || !toggleText || !toggleLink || !form) {
    console.error('Auth modal elements not found');
    return;
  }
  
  if (mode === 'login') {
    title.textContent = 'Login';
    submitBtn.textContent = 'Login';
    toggleText.textContent = "Don't have an account?";
    toggleLink.textContent = 'Sign Up';
    window.currentAuthMode = 'login';
  } else {
    title.textContent = 'Sign Up';
    submitBtn.textContent = 'Sign Up';
    toggleText.textContent = 'Already have an account?';
    toggleLink.textContent = 'Login';
    window.currentAuthMode = 'signup';
  }
  
  modal.style.display = 'flex';
  form.reset();
};

window.closeAuthModal = function() {
  const modal = document.getElementById('auth-modal');
  const form = document.getElementById('auth-form');
  if (modal) modal.style.display = 'none';
  if (form) form.reset();
};

window.toggleAuthMode = function() {
  const newMode = window.currentAuthMode === 'login' ? 'signup' : 'login';
  openAuthModal(newMode);
};

window.handleLogout = function() {
  // This will be overridden by main.js if Firebase is available
  alert('Logout functionality requires Firebase to be properly configured.');
};

// ============================================
// Profile Modal Functions
// ============================================
window.openProfileModal = function() {
  const modal = document.getElementById('profile-modal');
  if (!modal) {
    console.error('Profile modal not found');
    return;
  }
  
  // Get current user data
  const user = authModule?.getCurrentUser?.();
  if (!user) {
    alert('Please log in to view your profile');
    return;
  }
  
  // Populate profile fields
  const profileEmail = document.getElementById('profile-email');
  const profileDisplayName = document.getElementById('profile-display-name');
  const profileRole = document.getElementById('profile-role');
  
  if (profileEmail) profileEmail.textContent = user.email || '-';
  if (profileDisplayName) profileDisplayName.textContent = getDisplayName(user, null);
  if (profileRole) {
    const roleBadge = document.getElementById('user-role-badge');
    if (roleBadge) {
      profileRole.textContent = roleBadge.textContent || '-';
    }
  }
  
  modal.style.display = 'flex';
};

window.closeProfileModal = function() {
  const modal = document.getElementById('profile-modal');
  if (modal) modal.style.display = 'none';
};

window.handlePasswordReset = async function() {
  const user = authModule?.getCurrentUser?.();
  if (!user || !user.email) {
    alert('Please log in to reset your password');
    return;
  }
  
  try {
    const resetPassword = authModule?.resetPassword;
    if (!resetPassword) {
      alert('Password reset functionality is not available');
      return;
    }
    
    const result = await resetPassword(user.email);
    if (result.success) {
      alert(`Password reset link sent to ${user.email}. Please check your inbox.`);
    } else {
      alert(result.message);
    }
  } catch (error) {
    console.error('Password reset error:', error);
    alert('Failed to send password reset email. Please try again.');
  }
};

// ============================================
// Add Event Listeners for Auth Buttons
// ============================================
document.addEventListener('DOMContentLoaded', function() {
  // Login button
  const loginBtn = document.getElementById('login-btn');
  if (loginBtn) {
    loginBtn.addEventListener('click', function() {
      openAuthModal('login');
    });
  }
  
  // Signup button
  const signupBtn = document.getElementById('signup-btn');
  if (signupBtn) {
    signupBtn.addEventListener('click', function() {
      openAuthModal('signup');
    });
  }
  
  // Display name form
  const displayNameForm = document.getElementById('display-name-form');
  if (displayNameForm) {
    displayNameForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const newDisplayName = document.getElementById('new-display-name');
      if (!newDisplayName || !newDisplayName.value.trim()) {
        alert('Please enter a display name');
        return;
      }
      
      const displayName = newDisplayName.value.trim();
      const user = authModule?.getCurrentUser?.();
      
      if (!user) {
        alert('Please log in to update your display name');
        return;
      }
      
      try {
        // Update display name in Firebase (cache the import)
        if (!firebaseAuthModule) {
          firebaseAuthModule = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
        }
        await firebaseAuthModule.updateProfile(user, { displayName: displayName });
        
        // Update display name in backend
        const response = await fetch(`${API_BASE_URL}/api/users/${user.uid}/display-name`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'x-firebase-uid': user.uid
          },
          body: JSON.stringify({ displayName })
        });
        
        if (response.ok) {
          alert('Display name updated successfully!');
          
          // Update UI
          const userNameDisplay = document.getElementById('user-name-display');
          const profileDisplayName = document.getElementById('profile-display-name');
          if (userNameDisplay) userNameDisplay.textContent = displayName;
          if (profileDisplayName) profileDisplayName.textContent = displayName;
          
          newDisplayName.value = '';
        } else {
          throw new Error('Failed to update display name on server');
        }
      } catch (error) {
        console.error('Display name update error:', error);
        alert('Failed to update display name. Please try again.');
      }
    });
  }
});

// Configuration - Update this URL to your Railway backend URL after deployment
// For local development: http://localhost:3000
// For production: https://tutorslink.up.railway.app
const API_BASE_URL = window.location.hostname === 'localhost'
    ? 'http://localhost:3000'
    : 'https://tutorslink.up.railway.app';


// ============================================
// Utility Functions
// ============================================

// Show loading state
function showLoading(button) {
  button.disabled = true;
  button.dataset.originalText = button.textContent;
  button.textContent = 'Loading...';
}

// Hide loading state
function hideLoading(button) {
  button.disabled = false;
  button.textContent = button.dataset.originalText;
}

// Show success message
function showSuccess(message) {
  alert('‚úÖ ' + message);
}

// Show error message
function showError(message) {
  alert('‚ùå ' + message);
}

// ============================================
// Navigation & UI Helper Functions
// ============================================
function scrollToSection(sectionId) {
  const section = document.getElementById(sectionId);
  if (section) {
    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
}

function toggleCategory(card) {
  card.classList.toggle('expanded');
}

// ============================================
// User Role Management
// ============================================
// Note: currentUserRole is used internally for UI state management
let currentUserRole = 'guest';

// These functions are exposed globally for use in main.js and inline event handlers
// They are assigned to window for consistent access across modules
async function registerUser(firebaseUid, email, displayName) {
  try {
    const response = await fetch(`${API_BASE_URL}/api/users/register`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ firebaseUid, email, displayName })
    });
    
    const result = await response.json();
    if (result.success) {
      return result.data;
    }
  } catch (error) {
    console.error('Error registering user:', error);
  }
  return null;
}

async function fetchUserRole(firebaseUid) {
  try {
    const response = await fetch(`${API_BASE_URL}/api/users/me`, {
      headers: {
        'x-firebase-uid': firebaseUid
      }
    });
    
    const result = await response.json();
    if (result.success) {
      return result.data;
    }
  } catch (error) {
    console.error('Error fetching user role:', error);
  }
  return null;
}

function updateUIForRole(user, userData) {
  const role = userData?.role || 'guest';
  currentUserRole = role;
  
  // Update profile info in banner
  const profileInfo = document.getElementById('profile-info');
  const userNameDisplay = document.getElementById('user-name-display');
  const userRoleBadge = document.getElementById('user-role-badge');
  
  if (user) {
    profileInfo.style.display = 'flex';
    userNameDisplay.textContent = getDisplayName(user, userData);
    userRoleBadge.textContent = role.charAt(0).toUpperCase() + role.slice(1);
    userRoleBadge.className = `role-badge role-${role}`;
    
    // Show/hide nav buttons based on role
    const scheduleBtn = document.getElementById('schedule-nav-btn');
    const staffPortalBtn = document.getElementById('staff-portal-nav-btn');
    const bannerLoginBtn = document.getElementById('banner-login-btn');
    const bannerSignupBtn = document.getElementById('banner-signup-btn');
    const bannerProfileBtn = document.getElementById('banner-profile-btn');
    const bannerLogoutBtn = document.getElementById('banner-logout-btn');
    
    // Hide login/signup, show profile and logout
    if (bannerLoginBtn) bannerLoginBtn.style.display = 'none';
    if (bannerSignupBtn) bannerSignupBtn.style.display = 'none';
    if (bannerProfileBtn) bannerProfileBtn.style.display = 'inline-block';
    if (bannerLogoutBtn) bannerLogoutBtn.style.display = 'inline-block';
    
    // Show schedule for students, tutors, admins
    if (role === 'student' || role === 'tutor' || role === 'admin' || role === 'staff') {
      if (scheduleBtn) scheduleBtn.style.display = 'inline-block';
      document.getElementById('schedule').style.display = 'block';
    }
    
    // Show staff portal only for staff and admin
    if (role === 'staff' || role === 'admin') {
      if (staffPortalBtn) staffPortalBtn.style.display = 'inline-block';
      document.getElementById('staff-portal').style.display = 'block';
    }
  } else {
    profileInfo.style.display = 'none';
    currentUserRole = 'guest';
    
    // Show login/signup, hide profile and logout
    const bannerLoginBtn = document.getElementById('banner-login-btn');
    const bannerSignupBtn = document.getElementById('banner-signup-btn');
    const bannerProfileBtn = document.getElementById('banner-profile-btn');
    const bannerLogoutBtn = document.getElementById('banner-logout-btn');
    
    if (bannerLoginBtn) bannerLoginBtn.style.display = 'inline-block';
    if (bannerSignupBtn) bannerSignupBtn.style.display = 'inline-block';
    if (bannerProfileBtn) bannerProfileBtn.style.display = 'none';
    if (bannerLogoutBtn) bannerLogoutBtn.style.display = 'none';
    
    // Hide role-based sections
    document.getElementById('schedule').style.display = 'none';
    document.getElementById('staff-portal').style.display = 'none';
    const scheduleBtn = document.getElementById('schedule-nav-btn');
    const staffPortalBtn = document.getElementById('staff-portal-nav-btn');
    if (scheduleBtn) scheduleBtn.style.display = 'none';
    if (staffPortalBtn) staffPortalBtn.style.display = 'none';
  }
}

// Expose these functions to window for cross-module access
window.registerUser = registerUser;
window.fetchUserRole = fetchUserRole;
window.updateUIForRole = updateUIForRole;

// ============================================
// Policy Expansion
// ============================================
document.querySelectorAll('.policy').forEach(policy => {
  policy.addEventListener('click', () => {
    const content = policy.querySelector('.policy-content');
    content.style.display = (content.style.display === 'block') ? 'none' : 'block';
  });
});

// ============================================
// Fetch and Display Tutors on Page Load
// ============================================
async function fetchTutors() {
  try {
    const response = await fetch(`${API_BASE_URL}/api/tutors`);
    const result = await response.json();
    
    if (result.success && result.data.length > 0) {
      displayTutors(result.data);
    }
  } catch (error) {
    console.error('Error fetching tutors:', error);
    // Silently fail - don't show error to user on page load
  }
}

// Display tutors in the staff portal section
function displayTutors(tutors) {
  const tutorList = document.getElementById('tutor-list');
  tutorList.innerHTML = ''; // Clear existing tutors
  
  tutors.forEach(tutor => {
    // Create tutor box element safely
    const tutorBox = document.createElement('div');
    tutorBox.className = 'tutor-box';
    tutorBox.dataset.tutorId = tutor._id;
    
    // Create and append elements with proper text content (no XSS)
    const nameHeader = document.createElement('h4');
    nameHeader.textContent = tutor.name;
    
    const subjectsP = document.createElement('p');
    subjectsP.textContent = `Subjects: ${tutor.subjects}`;
    
    const priceP = document.createElement('p');
    priceP.textContent = `Price: ${tutor.price}`;
    
    const timezoneP = document.createElement('p');
    timezoneP.textContent = `Time Zone: ${tutor.timezone}`;
    
    const languagesP = document.createElement('p');
    languagesP.textContent = `Languages: ${tutor.languages}`;
    
    const categoryP = document.createElement('p');
    categoryP.textContent = `Category: ${tutor.category}`;
    
    const statusP = document.createElement('p');
    statusP.textContent = `Status: ${tutor.availability}`;
    
    // Create button with event listener (no inline onclick)
    const bookButton = document.createElement('button');
    bookButton.textContent = 'Book a Demo';
    bookButton.style.cssText = 'background:#ff0; color:#000; padding:8px 15px; border-radius:8px; margin-top:10px; cursor:pointer; border:none; font-weight:700;';
    bookButton.addEventListener('click', () => openBookingModal(tutor._id, tutor.name));
    
    // Append all elements
    tutorBox.appendChild(nameHeader);
    tutorBox.appendChild(subjectsP);
    tutorBox.appendChild(priceP);
    tutorBox.appendChild(timezoneP);
    tutorBox.appendChild(languagesP);
    tutorBox.appendChild(categoryP);
    tutorBox.appendChild(statusP);
    tutorBox.appendChild(bookButton);
    
    tutorList.appendChild(tutorBox);
  });
}

// Load tutors when page loads
window.addEventListener('DOMContentLoaded', fetchTutors);

// ============================================
// Add Tutor Form (Staff Portal)
// ============================================
const tutorForm = document.getElementById('add-tutor-form');
tutorForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const submitButton = tutorForm.querySelector('button[type="submit"]');
  showLoading(submitButton);
  
  // Get form data
  const formData = new FormData(tutorForm);
  const tutorData = {
    name: formData.get('name'),
    subjects: formData.get('subjects'),
    price: formData.get('price'),
    timezone: formData.get('timezone'),
    languages: formData.get('languages'),
    category: formData.get('category')
  };
  
  try {
    // Get current user for authentication
    const currentUser = authModule ? authModule.getCurrentUser() : null;
    
    if (!currentUser) {
      showError('Please login to add tutors');
      hideLoading(submitButton);
      return;
    }
    
    const response = await fetch(`${API_BASE_URL}/api/tutors`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-firebase-uid': currentUser.uid
      },
      body: JSON.stringify(tutorData)
    });
    
    const result = await response.json();
    
    if (result.success) {
      showSuccess('Tutor added successfully!');
      tutorForm.reset();
      // Refresh tutor list
      fetchTutors();
    } else {
      showError(result.message || 'Failed to add tutor');
    }
  } catch (error) {
    console.error('Error adding tutor:', error);
    showError('Network error. Please check your connection.');
  } finally {
    hideLoading(submitButton);
  }
});

// ============================================
// Booking Modal and Functionality
// ============================================

// Create booking modal dynamically
function createBookingModal() {
  const modalHTML = `
    <div id="booking-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:1000; justify-content:center; align-items:center;">
      <div style="background:#111; padding:40px; border-radius:20px; max-width:500px; width:90%; box-shadow:0 0 30px #ff00ff;">
        <h2 style="margin-bottom:20px; text-align:center;">Book a Demo Class</h2>
        <form id="booking-form">
          <input type="text" id="student-name" placeholder="Your Name" required style="width:100%; padding:12px; margin-bottom:15px; border-radius:8px; border:none;">
          <input type="email" id="student-email" placeholder="Your Email" required style="width:100%; padding:12px; margin-bottom:15px; border-radius:8px; border:none;">
          <textarea id="booking-message" placeholder="Tell us about your learning goals (optional)" rows="4" style="width:100%; padding:12px; margin-bottom:15px; border-radius:8px; border:none;"></textarea>
          <input type="hidden" id="selected-tutor-id">
          <div style="display:flex; gap:10px;">
            <button type="submit" style="flex:1; background:#ff0; color:#000; padding:12px; border-radius:8px; border:none; font-weight:700; cursor:pointer;">Submit Request</button>
            <button type="button" onclick="closeBookingModal()" style="flex:1; background:#666; color:#fff; padding:12px; border-radius:8px; border:none; font-weight:700; cursor:pointer;">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  `;
  document.body.insertAdjacentHTML('beforeend', modalHTML);
  
  // Add booking form submit handler
  const bookingForm = document.getElementById('booking-form');
  bookingForm.addEventListener('submit', handleBookingSubmit);
}

// Open booking modal
function openBookingModal(tutorId, tutorName) {
  const modal = document.getElementById('booking-modal');
  if (!modal) {
    createBookingModal();
  }
  
  document.getElementById('selected-tutor-id').value = tutorId;
  const modalElement = document.getElementById('booking-modal');
  modalElement.style.display = 'flex';
  
  // Update modal title with tutor name (safely using textContent)
  const modalTitle = modalElement.querySelector('h2');
  modalTitle.textContent = `Book a Demo with ${tutorName}`;
}

// Close booking modal
function closeBookingModal() {
  const modal = document.getElementById('booking-modal');
  modal.style.display = 'none';
  document.getElementById('booking-form').reset();
}

// Handle booking form submission
async function handleBookingSubmit(e) {
  e.preventDefault();
  
  const submitButton = e.target.querySelector('button[type="submit"]');
  showLoading(submitButton);
  
  const bookingData = {
    studentName: document.getElementById('student-name').value,
    studentEmail: document.getElementById('student-email').value,
    tutorId: document.getElementById('selected-tutor-id').value,
    message: document.getElementById('booking-message').value
  };
  
  try {
    const response = await fetch(`${API_BASE_URL}/api/bookings`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(bookingData)
    });
    
    const result = await response.json();
    
    if (result.success) {
      showSuccess('Booking request submitted! Our team will contact you soon.');
      closeBookingModal();
    } else {
      showError(result.message || 'Failed to submit booking');
    }
  } catch (error) {
    console.error('Error submitting booking:', error);
    showError('Network error. Please check your connection.');
  } finally {
    hideLoading(submitButton);
  }
}

// Close modal when clicking outside
window.addEventListener('click', (e) => {
  const modal = document.getElementById('booking-modal');
  if (modal && e.target === modal) {
    closeBookingModal();
  }
  
  // Close auth modal when clicking outside
  const authModal = document.getElementById('auth-modal');
  if (authModal && e.target === authModal) {
    closeAuthModal();
  }
});
</script>

<script type="module" src="./main.js">              
</script>

  
</body>
</html>
